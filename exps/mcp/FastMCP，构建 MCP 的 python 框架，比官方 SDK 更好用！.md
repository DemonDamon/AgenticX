# FastMCPï¼Œæ„å»º MCP çš„ python æ¡†æ¶ï¼Œæ¯”å®˜æ–¹ SDK æ›´å¥½ç”¨ï¼

åŸæ–‡é“¾æ¥: https://mp.weixin.qq.com/s/Sn_81RKOF-ileXfXd19f6g


![cover_image](images/2eefe360deb2f7611650b0dfd4fda7ce.jpg)


å‰æ–‡æˆ‘ä»¬åŸºäºå®˜æ–¹çš„ python SDKï¼Œä»‹ç»æœåŠ¡ç«¯ã€å®¢æˆ·ç«¯çš„ç¼–ç å®ç°ï¼Œä»¥åŠåŸºäº MCP çš„æ•°å­¦è¿ç®—æ™ºèƒ½é—®ç­”åº”ç”¨ï¼ˆ[MCPï¼šç¼–ç¨‹å®æˆ˜ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ æœåŠ¡ç«¯çš„å¼€å‘ä¸åŠŸèƒ½éªŒè¯](https://mp.weixin.qq.com/s?__biz=Mzk0Mjc0OTY1OA==&mid=2247484718&idx=1&sn=70832a64ced461ccc73292812a90addf&scene=21#wechat_redirect)ï¼›[MCPï¼šç¼–ç¨‹å®æˆ˜ï¼ŒåŸºäº SSE ä¼ è¾“æ–¹å¼çš„å®¢æˆ·ç«¯ç¼–ç å®ç°](https://mp.weixin.qq.com/s?__biz=Mzk0Mjc0OTY1OA==&mid=2247484770&idx=1&sn=e8af04cbc7063bfbfe549c17954ee501&scene=21#wechat_redirect)ï¼›[MCPï¼šç¼–ç¨‹å®æˆ˜ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ å®ç°æ•°å­¦è¿ç®—æ™ºèƒ½é—®ç­”åº”ç”¨](https://mp.weixin.qq.com/s?__biz=Mzk0Mjc0OTY1OA==&mid=2247484801&idx=1&sn=63dcf4a64b6f841d49dfcc64a1449f81&scene=21#wechat_redirect)ï¼‰ã€‚æœ¬æ–‡ä»‹ç» FastMCPï¼Œä¸€ä¸ªæ¯”å®˜æ–¹ SDK æ›´å¥½ç”¨çš„ python æ¡†æ¶ã€‚

**ç›¸æ¯”å®˜æ–¹ SDKï¼ŒFastMCPçš„ API è®¾è®¡æ›´åŠ ç®€æ´ã€å¼€å‘æ•ˆç‡æ›´é«˜ï¼Œä¸”å…·å¤‡æ›´å¼ºçš„å¯æ‰©å±•æ€§ï¼Œæ”¯æŒå¤šç§å®¢æˆ·ç«¯/æœåŠ¡ç«¯ä¼ è¾“æ¨¡å¼ï¼ˆStdioã€SSEã€å†…å­˜ï¼‰ã€èµ„æºæ¨¡æ¿æœºåˆ¶ï¼Œæå¤§åœ°é™ä½äº† MCP æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯çš„å¼€å‘é—¨æ§›**ã€‚

ç¬”è€…åœ¨ä½¿ç”¨ FastMCP è¿›è¡Œå¼€å‘ï¼Œæœ€å¤§çš„æ„Ÿæ‚Ÿæ˜¯ï¼š**ä¸å®˜æ–¹ SDK ç›¸æ¯”ï¼ŒFastMCP æå¤§åœ°é™ä½äº†å®¢æˆ·ç«¯çš„å¼€å‘æˆæœ¬ï¼ˆä¸€å¥ä»£ç ï¼Œå³å¯åˆ›å»º MCP å®¢æˆ·ç«¯ï¼‰ã€‚**

æœ¬æ–‡æ˜¯ MCP ç³»åˆ—æ–‡ç« çš„ç¬¬å…­ç¯‡ã€‚æœ¬æ–‡çš„ä¸»è¦å†…å®¹ï¼š

1. FastMCP ä»‹ç»
2. å¼€å‘ç¤ºä¾‹ï¼šåŸºäº FastMCP çš„æ•°å­¦è¿ç®—æ™ºèƒ½é—®ç­”åº”ç”¨å®ç°

![]()
### FastMCP

* é¡¹ç›®åœ°å€ï¼šhttps://github.com/jlowin/fastmcp
* é¡¹ç›®æ–‡æ¡£åœ°å€ï¼šhttps://gofastmcp.com/getting-started/welcome

#### FastMCP ä¸å®˜æ–¹ SDK çš„å…³ç³»

FastMCP æ˜¯æ„å»º MCP æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯çš„æ ‡å‡†æ¡†æ¶ã€‚FastMCP 1.0 å·²è¢«çº³å…¥å®˜æ–¹ MCP Python SDKã€‚

å½“å‰ FastMCP å·²æ›´æ–°è‡³ 2.0 ç‰ˆæœ¬ï¼Œ2.0 ç‰ˆæœ¬é€šè¿‡å¼•å…¥å®Œæ•´çš„å®¢æˆ·ç«¯æ”¯æŒã€æœåŠ¡å™¨ç»„åˆã€OpenAPI/FastAPI é›†æˆã€è¿œç¨‹æœåŠ¡å™¨ä»£ç†ã€å†…ç½®æµ‹è¯•å·¥å…·ç­‰åŠŸèƒ½ï¼Œæ˜¾è‘—æ‰©å±•äº† 1.0 ç‰ˆæœ¬çš„åŸºç¡€æœåŠ¡å™¨æ„å»ºèƒ½åŠ›ã€‚

#### ä¸ºä»€ä¹ˆé€‰æ‹©FastMCPï¼Ÿ

MCP åè®®åŠŸèƒ½å¼ºå¤§ï¼Œä½†å…¶å®ç°æ¶‰åŠå¤§é‡é‡å¤æ€§å·¥ä½œâ€”â€”åŒ…æ‹¬æœåŠ¡å™¨è®¾ç½®ã€åè®®å¤„ç†å™¨ã€å†…å®¹ç±»å‹å¤„ç†å’Œé”™è¯¯ç®¡ç†ç­‰ã€‚FastMCPå¤„ç†äº†æ‰€æœ‰å¤æ‚çš„åè®®ç»†èŠ‚å’ŒæœåŠ¡å™¨ç®¡ç†ï¼Œè®©å¼€å‘è€…èƒ½ä¸“æ³¨äºæ„å»ºä¼˜è´¨å·¥å…·ã€‚å…¶è®¾è®¡ç‰¹ç‚¹åŒ…æ‹¬ï¼š

* ğŸª„Â **é«˜çº§æŠ½è±¡**ï¼šé€šå¸¸åªéœ€é€šè¿‡è£…é¥°å™¨ï¼ˆDecoratorï¼‰å³å¯å®šä¹‰åŠŸèƒ½ï¼›
* ğŸŒ±Â **å»¶ç»­æ€§åˆ›æ–°**ï¼šFastMCP 1.0çš„æ ¸å¿ƒæ¦‚å¿µå·²è¢«è´¡çŒ®ç»™å®˜æ–¹ MCP SDKï¼Œè€ŒFastMCP 2.0ï¼ˆå½“å‰é¡¹ç›®ï¼‰ä½œä¸ºæ´»è·ƒå¼€å‘çš„ç‰ˆæœ¬ï¼Œæ–°å¢äº†å¤šé¡¹å¢å¼ºåŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼šå¼ºå¤§çš„å®¢æˆ·ç«¯åº“ã€æœåŠ¡å™¨ä»£ç†ä¸ç»„åˆæ¨¡å¼ã€OpenAPI/FastAPIé›†æˆã€å…¶ä»–æ‰©å±•èƒ½åŠ›ã€‚

#### FastMCPçš„è®¾è®¡ç›®æ ‡

* ğŸš€Â **å¿«é€Ÿ**ï¼šé«˜çº§æ¥å£å‡å°‘ä»£ç é‡ï¼ŒåŠ é€Ÿå¼€å‘è¿›ç¨‹
* ğŸ€Â **ç®€æ´**ï¼šä»¥æœ€å°åŒ–æ ·æ¿ä»£ç æ„å»ºMCPæœåŠ¡å™¨
* ğŸÂ **ç¬¦åˆPythonä¹ æƒ¯**ï¼šè®©Pythonå¼€å‘è€…è‡ªç„¶ä¸Šæ‰‹
* ğŸ”Â **å®Œæ•´**ï¼šå…¨é¢æ”¯æŒMCPæ ¸å¿ƒè§„èŒƒçš„æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å®ç°

### å¼€å‘ç¤ºä¾‹

#### å®‰è£…

è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®‰è£… FastMCPï¼š

```
uv pip install fastmcp  

```
#### æœåŠ¡ç«¯å®ç°

```
fromÂ fastmcpÂ importÂ FastMCP  
  
mcp = FastMCP(name="MyAssistantServer")  
  
  
@mcp.tool()  
defÂ add(a: float, b: float)Â -> float:  
Â  Â Â """åŠ æ³•è¿ç®—  
  
Â  Â  å‚æ•°:  
Â  Â  a: ç¬¬ä¸€ä¸ªæ•°å­—  
Â  Â  b: ç¬¬äºŒä¸ªæ•°å­—  
  
Â  Â  è¿”å›:  
Â  Â  ä¸¤æ•°ä¹‹å’Œ  
Â  Â  """  
Â  Â Â returnÂ a + b  
  
  
@mcp.tool()  
defÂ subtract(a: float, b: float)Â -> float:  
Â  Â Â """å‡æ³•è¿ç®—  
  
Â  Â  å‚æ•°:  
Â  Â  a: ç¬¬ä¸€ä¸ªæ•°å­—  
Â  Â  b: ç¬¬äºŒä¸ªæ•°å­—  
  
Â  Â  è¿”å›:  
Â  Â  ä¸¤æ•°ä¹‹å·® (a - b)  
Â  Â  """  
Â  Â Â returnÂ a - b  
  
  
@mcp.tool()  
defÂ multiply(a: float, b: float)Â -> float:  
Â  Â Â """ä¹˜æ³•è¿ç®—  
  
Â  Â  å‚æ•°:  
Â  Â  a: ç¬¬ä¸€ä¸ªæ•°å­—  
Â  Â  b: ç¬¬äºŒä¸ªæ•°å­—  
  
Â  Â  è¿”å›:  
Â  Â  ä¸¤æ•°ä¹‹ç§¯  
Â  Â  """  
Â  Â Â returnÂ a * b  
  
  
@mcp.tool()  
defÂ divide(a: float, b: float)Â -> float:  
Â  Â Â """é™¤æ³•è¿ç®—  
  
Â  Â  å‚æ•°:  
Â  Â  a: è¢«é™¤æ•°  
Â  Â  b: é™¤æ•°  
  
Â  Â  è¿”å›:  
Â  Â  ä¸¤æ•°ä¹‹å•† (a / b)  
  
Â  Â  å¼‚å¸¸:  
Â  Â  ValueError: å½“é™¤æ•°ä¸ºé›¶æ—¶  
Â  Â  """  
Â  Â Â ifÂ b ==Â 0:  
Â  Â  Â  Â Â raiseÂ ValueError("é™¤æ•°ä¸èƒ½ä¸ºé›¶")  
Â  Â Â returnÂ a / b  
  
  
ifÂ __name__ ==Â "__main__":  
Â  Â  mcp.run(transport='sse', host="127.0.0.1", port=8001)  

```
#### å®¢æˆ·ç«¯å®ç°

åªéœ€ä¸€è¡Œä»£ç ï¼ˆæŒ‡å®šè¿æ¥åˆ°æœåŠ¡ç«¯çš„æ–¹å¼ï¼‰ï¼Œå³å¯åˆ›å»º MCP å®¢æˆ·ç«¯ï¼š

```
asyncÂ defÂ main():  
Â  Â Â # æµ‹è¯• mcp å®¢æˆ·ç«¯çš„åŠŸèƒ½  
Â  Â Â asyncÂ withÂ Client("http://127.0.0.1:8001/sse")Â asÂ mcp_client:  
Â  Â  Â  Â  tools =Â awaitÂ mcp_client.list_tools()  
Â  Â  Â  Â  print(f"Available tools:Â {tools}")  
Â  Â  Â  Â  result =Â awaitÂ mcp_client.call_tool("add", {"a":Â 5,Â "b":Â 3})  
Â  Â  Â  Â  print(f"Result:Â {result[0].text}")  

```
#### æ•°å­¦è¿ç®—æ™ºèƒ½é—®ç­”åº”ç”¨

åŸºäº FastMCP å®ç°çš„æ•°å­¦è¿ç®—æ™ºèƒ½é—®ç­”åº”ç”¨å®ç°å¦‚ä¸‹ï¼ˆè¯¦ç»†è®¾è®¡æ€è·¯ï¼Œå¯é˜…è¯»å‰æ–‡ï¼š[MCPï¼šç¼–ç¨‹å®æˆ˜ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ å®ç°æ•°å­¦è¿ç®—æ™ºèƒ½é—®ç­”åº”ç”¨](https://mp.weixin.qq.com/s?__biz=Mzk0Mjc0OTY1OA==&mid=2247484801&idx=1&sn=63dcf4a64b6f841d49dfcc64a1449f81&scene=21#wechat_redirect)ï¼‰

```
classÂ LLMClient:  
Â  Â Â """LLMå®¢æˆ·ç«¯ï¼Œè´Ÿè´£ä¸å¤§è¯­è¨€æ¨¡å‹APIé€šä¿¡"""  
  
Â  Â Â defÂ __init__(self, model_name: str, url: str, api_key: str)Â ->Â None:  
Â  Â  Â  Â  self.model_name: str = model_name  
Â  Â  Â  Â  self.url: str = url  
Â  Â  Â  Â  self.client = OpenAI(api_key=api_key, base_url=url)  
  
Â  Â Â defÂ get_response(self, messages: list[dict[str, str]])Â -> str:  
Â  Â  Â  Â Â """å‘é€æ¶ˆæ¯ç»™LLMå¹¶è·å–å“åº”"""  
Â  Â  Â  Â  response = self.client.chat.completions.create(  
Â  Â  Â  Â  Â  Â  model=self.model_name,  
Â  Â  Â  Â  Â  Â  messages=messages,  
Â  Â  Â  Â  Â  Â  stream=False  
Â  Â  Â  Â  )  
Â  Â  Â  Â Â returnÂ response.choices[0].message.content  
  
  
classÂ ChatSession:  
Â  Â Â """èŠå¤©ä¼šè¯ï¼Œå¤„ç†ç”¨æˆ·è¾“å…¥å’ŒLLMå“åº”ï¼Œå¹¶ä¸MCPå·¥å…·äº¤äº’"""  
  
Â  Â Â defÂ __init__(self, llm_client: LLMClient, mcp_client: Client, )Â ->Â None:  
Â  Â  Â  Â  self.mcp_client: Client = mcp_client  
Â  Â  Â  Â  self.llm_client: LLMClient = llm_client  
  
Â  Â Â asyncdefÂ process_llm_response(self, llm_response: str)Â -> str:  
Â  Â  Â  Â Â """å¤„ç†LLMå“åº”ï¼Œè§£æå·¥å…·è°ƒç”¨å¹¶æ‰§è¡Œ"""  
Â  Â  Â  Â Â try:  
Â  Â  Â  Â  Â  Â Â # å°è¯•ç§»é™¤å¯èƒ½çš„markdownæ ¼å¼  
Â  Â  Â  Â  Â  Â Â ifÂ llm_response.startswith('```json'):  
Â  Â  Â  Â  Â  Â  Â  Â  llm_response = llm_response.strip('```json').strip('```').strip()  
Â  Â  Â  Â  Â  Â  tool_call = json.loads(llm_response)  
Â  Â  Â  Â  Â  Â Â if"tool"inÂ tool_callÂ and"arguments"inÂ tool_call:  
Â  Â  Â  Â  Â  Â  Â  Â Â # æ£€æŸ¥å·¥å…·æ˜¯å¦å¯ç”¨  
Â  Â  Â  Â  Â  Â  Â  Â  tools =Â awaitÂ self.mcp_client.list_tools()  
Â  Â  Â  Â  Â  Â  Â  Â Â ifÂ any(tool.name == tool_call["tool"]Â forÂ toolÂ inÂ tools):  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â try:  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â # æ‰§è¡Œå·¥å…·è°ƒç”¨  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  result =Â awaitÂ self.mcp_client.call_tool(  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tool_call["tool"], tool_call["arguments"]  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  )  
  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â returnf"Tool execution result:Â {result}"  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â exceptÂ ExceptionÂ asÂ e:  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  error_msg =Â f"Error executing tool:Â {str(e)}"  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  logging.error(error_msg)  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â returnÂ error_msg  
Â  Â  Â  Â  Â  Â  Â  Â Â returnf"No server found with tool:Â {tool_call['tool']}"  
Â  Â  Â  Â  Â  Â Â returnÂ llm_response  
Â  Â  Â  Â Â exceptÂ json.JSONDecodeError:  
Â  Â  Â  Â  Â  Â Â # å¦‚æœä¸æ˜¯JSONæ ¼å¼ï¼Œç›´æ¥è¿”å›åŸå§‹å“åº”  
Â  Â  Â  Â  Â  Â Â returnÂ llm_response  
  
Â  Â Â asyncdefÂ start(self, system_message)Â ->Â None:  
Â  Â  Â  Â Â """å¯åŠ¨èŠå¤©ä¼šè¯çš„ä¸»å¾ªç¯"""  
Â  Â  Â  Â  messages = [{"role":Â "system",Â "content": system_message}]  
Â  Â  Â  Â Â whileTrue:  
Â  Â  Â  Â  Â  Â Â try:  
Â  Â  Â  Â  Â  Â  Â  Â Â # è·å–ç”¨æˆ·è¾“å…¥  
Â  Â  Â  Â  Â  Â  Â  Â  user_input = input("ç”¨æˆ·: ").strip().lower()  
Â  Â  Â  Â  Â  Â  Â  Â Â ifÂ user_inputÂ inÂ ["quit",Â "exit",Â "é€€å‡º"]:  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  print('AIåŠ©æ‰‹é€€å‡º')  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â break  
Â  Â  Â  Â  Â  Â  Â  Â  messages.append({"role":Â "user",Â "content": user_input})  
  
Â  Â  Â  Â  Â  Â  Â  Â Â # è·å–LLMçš„åˆå§‹å“åº”  
Â  Â  Â  Â  Â  Â  Â  Â  llm_response = self.llm_client.get_response(messages)  
Â  Â  Â  Â  Â  Â  Â  Â  print("åŠ©æ‰‹: ", llm_response)  
  
Â  Â  Â  Â  Â  Â  Â  Â Â # å¤„ç†å¯èƒ½çš„å·¥å…·è°ƒç”¨  
Â  Â  Â  Â  Â  Â  Â  Â  result =Â awaitÂ self.process_llm_response(llm_response)  
  
Â  Â  Â  Â  Â  Â  Â  Â Â # å¦‚æœå¤„ç†ç»“æœä¸åŸå§‹å“åº”ä¸åŒï¼Œè¯´æ˜æ‰§è¡Œäº†å·¥å…·è°ƒç”¨ï¼Œéœ€è¦è¿›ä¸€æ­¥å¤„ç†  
Â  Â  Â  Â  Â  Â  Â  Â Â whileÂ result != llm_response:  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  messages.append({"role":Â "assistant",Â "content": llm_response})  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  messages.append({"role":Â "system",Â "content": result})  
  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â # å°†å·¥å…·æ‰§è¡Œç»“æœå‘é€å›LLMè·å–æ–°å“åº”  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  llm_response = self.llm_client.get_response(messages)  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  result =Â awaitÂ self.process_llm_response(llm_response)  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  print("åŠ©æ‰‹: ", llm_response)  
  
Â  Â  Â  Â  Â  Â  Â  Â  messages.append({"role":Â "assistant",Â "content": llm_response})  
  
Â  Â  Â  Â  Â  Â Â exceptÂ KeyboardInterrupt:  
Â  Â  Â  Â  Â  Â  Â  Â  print('AIåŠ©æ‰‹é€€å‡º')  
Â  Â  Â  Â  Â  Â  Â  Â Â break  
  
  
asyncdefÂ main():  
Â  Â Â asyncwithÂ Client("http://127.0.0.1:8001/sse")Â asÂ mcp_client:  
Â  Â  Â  Â Â # åˆå§‹åŒ–LLMå®¢æˆ·ç«¯ï¼Œä½¿ç”¨é€šä¹‰åƒé—®æ¨¡å‹  
Â  Â  Â  Â  llm_client = LLMClient(model_name='qwen-plus-latest', api_key=os.getenv('DASHSCOPE_API_KEY'),  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â url='https://dashscope.aliyuncs.com/compatible-mode/v1')  
  
Â  Â  Â  Â Â # è·å–å¯ç”¨å·¥å…·åˆ—è¡¨å¹¶æ ¼å¼åŒ–ä¸ºç³»ç»Ÿæç¤ºçš„ä¸€éƒ¨åˆ†  
Â  Â  Â  Â  tools =Â awaitÂ mcp_client.list_tools()  
Â  Â  Â  Â  dict_list = [tool.__dict__Â forÂ toolÂ inÂ tools]  
Â  Â  Â  Â  tools_description = json.dumps(dict_list, ensure_ascii=False)  
  
Â  Â  Â  Â Â # ç³»ç»Ÿæç¤ºï¼ŒæŒ‡å¯¼LLMå¦‚ä½•ä½¿ç”¨å·¥å…·å’Œè¿”å›å“åº”  
Â  Â  Â  Â  system_message =Â f'''  
Â  Â  Â  Â  Â  Â  Â  Â  ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹ï¼Œä¸¥æ ¼éµå¾ªä»¥ä¸‹åè®®è¿”å›å“åº”ï¼š  
  
Â  Â  Â  Â  Â  Â  Â  Â  å¯ç”¨å·¥å…·ï¼š{tools_description}  
  
Â  Â  Â  Â  Â  Â  Â  Â  å“åº”è§„åˆ™ï¼š  
Â  Â  Â  Â  Â  Â  Â  Â  1ã€å½“éœ€è¦è®¡ç®—æ—¶ï¼Œè¿”å›ä¸¥æ ¼ç¬¦åˆä»¥ä¸‹æ ¼å¼çš„çº¯å‡€JSONï¼š  
Â  Â  Â  Â  Â  Â  Â  Â  {{  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "tool": "tool-name",  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "arguments": {{  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "argument-name": "value"  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }}  
Â  Â  Â  Â  Â  Â  Â  Â  }}  
Â  Â  Â  Â  Â  Â  Â  Â  2ã€ç¦æ­¢åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š  
Â  Â  Â  Â  Â  Â  Â  Â  Â - Markdownæ ‡è®°ï¼ˆå¦‚```jsonï¼‰  
Â  Â  Â  Â  Â  Â  Â  Â  Â - è‡ªç„¶è¯­è¨€è§£é‡Šï¼ˆå¦‚"ç»“æœï¼š"ï¼‰  
Â  Â  Â  Â  Â  Â  Â  Â  Â - æ ¼å¼åŒ–æ•°å€¼ï¼ˆå¿…é¡»ä¿æŒåŸå§‹ç²¾åº¦ï¼‰  
Â  Â  Â  Â  Â  Â  Â  Â  Â - å•ä½ç¬¦å·ï¼ˆå¦‚å…ƒã€kgï¼‰  
  
Â  Â  Â  Â  Â  Â  Â  Â  æ ¡éªŒæµç¨‹ï¼š  
Â  Â  Â  Â  Â  Â  Â  Â  âœ“ å‚æ•°æ•°é‡ä¸å·¥å…·å®šä¹‰ä¸€è‡´  
Â  Â  Â  Â  Â  Â  Â  Â  âœ“ æ•°å€¼ç±»å‹ä¸ºnumber  
Â  Â  Â  Â  Â  Â  Â  Â  âœ“ JSONæ ¼å¼æœ‰æ•ˆæ€§æ£€æŸ¥  
  
Â  Â  Â  Â  Â  Â  Â  Â  æ­£ç¡®ç¤ºä¾‹ï¼š  
Â  Â  Â  Â  Â  Â  Â  Â  ç”¨æˆ·ï¼šå•ä»·88.5ä¹°235ä¸ªå¤šå°‘é’±ï¼Ÿ  
Â  Â  Â  Â  Â  Â  Â  Â  å“åº”ï¼š{{"tool":"multiply","arguments":{{"a":88.5,"b":235}}}}  
  
Â  Â  Â  Â  Â  Â  Â  Â  é”™è¯¯ç¤ºä¾‹ï¼š  
Â  Â  Â  Â  Â  Â  Â  Â  ç”¨æˆ·ï¼šæ€»é‡‘é¢æ˜¯å¤šå°‘ï¼Ÿ  
Â  Â  Â  Â  Â  Â  Â  Â  é”™è¯¯å“åº”ï¼šæ€»ä»·500å…ƒ â†’ å«è‡ªç„¶è¯­è¨€  
Â  Â  Â  Â  Â  Â  Â  Â  é”™è¯¯å“åº”ï¼š```json{{...}}``` â†’ å«Markdown  
  
Â  Â  Â  Â  Â  Â  Â  Â  3ã€åœ¨æ”¶åˆ°å·¥å…·çš„å“åº”åï¼š  
Â  Â  Â  Â  Â  Â  Â  Â  Â - å°†åŸå§‹æ•°æ®è½¬åŒ–ä¸ºè‡ªç„¶ã€å¯¹è¯å¼çš„å›åº”  
Â  Â  Â  Â  Â  Â  Â  Â  Â - ä¿æŒå›å¤ç®€æ´ä½†ä¿¡æ¯ä¸°å¯Œ  
Â  Â  Â  Â  Â  Â  Â  Â  Â - èšç„¦äºæœ€ç›¸å…³çš„ä¿¡æ¯  
Â  Â  Â  Â  Â  Â  Â  Â  Â - ä½¿ç”¨ç”¨æˆ·é—®é¢˜ä¸­çš„é€‚å½“ä¸Šä¸‹æ–‡  
Â  Â  Â  Â  Â  Â  Â  Â  Â - é¿å…ç®€å•é‡å¤ä½¿ç”¨åŸå§‹æ•°æ®  
Â  Â  Â  Â  Â  Â  Â  Â  '''  
Â  Â  Â  Â Â # å¯åŠ¨èŠå¤©ä¼šè¯  
Â  Â  Â  Â  chat_session = ChatSession(llm_client=llm_client, mcp_client=mcp_client)  
Â  Â  Â  Â Â awaitÂ chat_session.start(system_message=system_message)  
  
ifÂ __name__ ==Â "__main__":  
Â  Â  asyncio.run(main())  

```
#### è¿è¡ŒéªŒè¯

1. è¿è¡ŒæœåŠ¡ç«¯ï¼špython fast\_mcp\_server.py

![]()

1. è¿è¡Œæ•°å­¦è¿ç®—æ™ºèƒ½é—®ç­”åº”ç”¨

```
D:\python_project\mcp_learning\.venv\Scripts\python.exe D:\python_project\mcp_learning\fast_mcp\fast_mcp_client.pyÂ   
ç”¨æˆ·: ç°åœ¨è¦è´­ä¹°ä¸€æ‰¹è´§ï¼Œå•ä»·æ˜¯ 1034.32423ï¼Œæ•°é‡æ˜¯ 235326ã€‚å•†å®¶åæ¥åˆè¯´ï¼Œå¯ä»¥åœ¨è¿™ä¸ªåŸºç¡€ä¸Šï¼Œæ‰“95æŠ˜ï¼ŒæŠ˜åæ€»ä»·æ˜¯å¤šå°‘ï¼Ÿ  
åŠ©æ‰‹: Â {  
Â  "tool": "multiply",  
Â  "arguments": {  
Â  Â  "a": 1034.32423,  
Â  Â  "b": 235326  
Â  }  
}  
åŠ©æ‰‹: Â {  
Â  "tool": "multiply",  
Â  "arguments": {  
Â  Â  "a": 243403383.74898,  
Â  Â  "b": 0.95  
Â  }  
}  
åŠ©æ‰‹: Â æŠ˜åæ€»ä»·æ˜¯231233214.56ã€‚  
ç”¨æˆ·: æˆ‘å’Œå•†å®¶å…³ç³»æ¯”è¾ƒå¥½ï¼Œå•†å®¶è¯´ï¼Œå¯ä»¥åœ¨ä¸Šé¢çš„åŸºç¡€ä¸Šï¼Œå†è¿”å›ä¸¤ä¸ªç‚¹ï¼Œæœ€åæ€»ä»·æ˜¯å¤šå°‘ï¼Ÿ  
åŠ©æ‰‹: Â {  
Â  "tool": "multiply",  
Â  "arguments": {  
Â  Â  "a": 231233214.56153098,  
Â  Â  "b": 0.98  
Â  }  
}  
åŠ©æ‰‹: Â æœ€ç»ˆæ€»ä»·æ˜¯226608550.27ã€‚  
ç”¨æˆ·: quit  
AIåŠ©æ‰‹é€€å‡º  
  
Process finished with exit code 0  

```
